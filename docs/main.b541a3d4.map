{"version":3,"sources":["constant.ts","player/player.ts","player/sample.ts","main.ts"],"names":[],"mappings":"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","file":"main.b541a3d4.map","sourceRoot":"..\\src","sourcesContent":["export const playBtn = document.getElementById(\"play\")!;\r\nexport const stopBtn = document.getElementById(\"stop\")!;\r\nexport const gainRange = <HTMLInputElement>document.getElementById(\"gain\")!;\r\nexport const sineSpeed = <HTMLInputElement>document.getElementById(\"sinewave-speed\")!;\r\nexport const sineLoadBtn = document.getElementById(\"load-sinewave\")!;\r\n\r\nexport const sampleSpeed = <HTMLInputElement>document.getElementById(\"sample-speed\")!;\r\nexport const kickLoadBtn = document.getElementById(\"load-kick\")!;","//import { sineWave } from './sample'\r\nexport class ngPlayer {\r\n  audioCtx: AudioContext\r\n  mixerNode: ScriptProcessorNode\r\n  masterGainNode: GainNode\r\n  constructor() {\r\n    this.audioCtx = new AudioContext();\r\n    this.mixerNode = this.audioCtx.createScriptProcessor(1024, 1, 1);\r\n    this.masterGainNode = this.audioCtx.createGain();\r\n    this.masterGainNode.gain.value = 0.5;\r\n    this.masterGainNode.connect(this.audioCtx.destination);\r\n  }\r\n\r\n  load(fn: (this: ScriptProcessorNode, ev: AudioProcessingEvent) => any) {\r\n    this.mixerNode.onaudioprocess = fn;\r\n    //sineWave(0.1)\r\n  }\r\n\r\n  play() {\r\n    this.mixerNode.connect(this.masterGainNode);\r\n  }\r\n\r\n  stop() {\r\n    this.mixerNode.disconnect();\r\n  }\r\n\r\n  getMasterGain() {\r\n    return this.masterGainNode.gain.value;\r\n  }\r\n\r\n  setMasterGain(value: number) {\r\n    console.log(value);\r\n    this.masterGainNode.gain.value = value;\r\n  }\r\n}\r\n","export const sineWave = (speed=0.2, gain=1.0, offset=0) => {\r\n  let x = offset\r\n  return (e: AudioProcessingEvent) => {\r\n    const data = e.outputBuffer.getChannelData(0);\r\n    for (let i = 0; i < data.length; ++i) {\r\n      x+=speed;\r\n      data[i] = Math.sin(x) * gain;\r\n    }\r\n  }\r\n}\r\n\r\nexport const kick = (speed=1, gain=1.0, offset=0, loop=true) => {\r\n  const xmap = [0.75, 0.9, 1, 0.9, 0.5, 0.1, 0, 0.1, 0.5, 0.75, 0.85, 0.9, 0.85, 0.75, 0.5, 0.25, 0.15, 0.1, 0.15, 0.25, 0.4, 0.5, 0.6, 0.75, 0.8, 0.85, 0.8, 0.75, 0.6, 0.5, 0.4, 0.3, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.66, 0.62, 0.6, 0.55, 0.5, 0.48, 0.45, 0.44, 0.45, 0.46, 0.48, 0.5, 0.52, 0.54, 0.55, 0.54, 0.52, 0.51, 0.5 ]\r\n  let x = offset\r\n  const baseSpeed = 0.02;\r\n  speed = baseSpeed * speed;\r\n  return (e: AudioProcessingEvent) => {\r\n    const data = e.outputBuffer.getChannelData(0);\r\n    for (let i = 0; i < data.length; ++i) {\r\n      x += speed;\r\n      if (loop === true && x > xmap.length) x=0;\r\n      if (x > xmap.length) {data[i] = 0.5; continue;}\r\n      const base = Math.floor(x);\r\n      const diff = x - base\r\n      const next = base === xmap.length ?  xmap[0] : xmap[base+1];\r\n      const value = (xmap[base] - (xmap[base] - next) * diff);\r\n      data[i] = value;\r\n    }\r\n  }\r\n}\r\n\r\n/*\r\nexport const rhythm = (bpm=160) => {\r\n  let x = 0\r\n  return (e: AudioProcessingEvent) => {\r\n    const data = e.outputBuffer.getChannelData(0);\r\n    for (let i = 0; i < data.length; ++i) {\r\n      x+=speed;\r\n      data[i] = Math.sin(x);\r\n    }\r\n  }\r\n}\r\n*/\r\n/*\r\n\r\nexport const sineWave = {\r\n  x: 0,\r\n  play: (e: AudioProcessingEvent) => {\r\n    var data = e.outputBuffer.getChannelData(0);\r\n    for (var i = 0; i < data.length; ++i) {\r\n      data[i] = Math.sin(this.x++);\r\n    }\r\n  }\r\n}\r\n*/","import { playBtn, stopBtn, gainRange, sineLoadBtn, sineSpeed, kickLoadBtn, sampleSpeed } from './constant'\r\nimport { ngPlayer } from './player/player'\r\nimport { sineWave, kick } from './player/sample'\r\n\r\nconst player = new ngPlayer\r\n\r\n//player.load()\r\n\r\nplayBtn.onclick = () => {player.play()}\r\nstopBtn.onclick = () => {player.stop()}\r\ngainRange.value = player.getMasterGain().toString()\r\ngainRange.onchange = (e) => {\r\n  player.setMasterGain(parseFloat(gainRange.value))\r\n}\r\nsineSpeed.value = \"0.2\"\r\nsineLoadBtn.onclick = () => {\r\n  player.load(sineWave(parseFloat(sineSpeed.value)))\r\n}\r\nkickLoadBtn.onclick = () => {\r\n  player.load(kick(parseFloat(sampleSpeed.value)))\r\n}\r\n\r\nplayer.load(sineWave(parseFloat(sineSpeed.value)))"]}